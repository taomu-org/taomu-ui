import{c as me,a as o,j as xe,l as N}from"./mini-scrollbar-CovzJoiJ.js";import{R as c}from"./index-DRjF_FHU.js";import{u as ge,a as oe,c as pe}from"./use-taomu-classname-DM2_Z24H.js";import{i as ye,a as Se,b as be}from"./input.styled-CAYR-obT.js";import"./index-gPDqJng4.js";import"./index-_UnNtNEu.js";import{s as Ie}from"./global-style-emPCDtl7.js";import{D as Oe}from"./dropdown-CclC1Dz-.js";import{L as he}from"./loading-C9fjBMuP.js";import{S as ke,C as Ee,a as Re}from"./search-C40fYa5O.js";Ie("common",{});const Te=me``,A=c.forwardRef(({className:L,cssVars:H,style:U,status:$="default",allowClear:Ce,width:v="100%",height:J=32,padding:Q="0 8px",placeholder:X,radius:Y,leftNode:Z,rightNode:z,showSearch:s,options:n,loading:F,defaultOpened:K=!1,openOnFocus:w,closeOnBlur:B=!0,dropdownProps:p={},name:P,labelProp:D="label",valueProp:u="value",filterProp:y="label",value:a,onChange:O,onFocus:h,onBlur:k,onKeyDown:E,...ee},te)=>{const f=c.useRef(null),d=c.useRef(null),[S,R]=c.useState(!1),[x,G]=c.useState(K),[m,b]=c.useState(),[g,j]=c.useState(""),ne=ge("select","flex row center-v gap-6",`status-${$}`,{focused:S},L),re=oe({inputWidth:v,inputHeight:J,inputPadding:Q,inputRadius:Y,...H},U);c.useImperativeHandle(te,M),c.useEffect(()=>{var e,t;S?(e=f.current)==null||e.focus():(t=f.current)==null||t.blur()},[S]),c.useEffect(()=>{var e;if(s){const t=n==null?void 0:n.find(r=>r[u]==a);t&&j(((e=t==null?void 0:t.label)==null?void 0:e.toString())||"")}},[a,s,u]);const i=c.useMemo(()=>{var t;const e=[];if(!(n!=null&&n.length))return e;for(let r=0;r<n.length;r++){const l=n[r];if(s&&g){const I=typeof y=="string"?[y]:y;let q=!1;for(let _=0;_<I.length;_++){const de=I[_];if((t=l[de])!=null&&t.includes(g)){q=!0;break}}if(!q)continue}e.push({key:(l.key||l[u])??r,active:m===r,...l})}return e},[n,m,g,y]);c.useEffect(()=>{T()},[a,g]);const ce=c.useMemo(()=>{if(s)return g;if(!a)return"";const e=n==null?void 0:n.find(r=>r[u]==a);return(e==null?void 0:e[D])||a},[a,n,D,u,g,s]);function M(){return{target:{name:P,value:a},opened:x,input:f.current,dropdown:d.current,setFocused:R}}function le(e){const t=n==null?void 0:n.findIndex(I=>I.value==e);if(t===void 0||t<0)return;const r=n==null?void 0:n[t];b(t);const l=M();l.target.value=e,O==null||O(l,r==null?void 0:r[u],r)}function V(e=0){const t=i==null?void 0:i[e<0?0:e];t&&(le(t[u]),C())}function T(){const e=n==null?void 0:n.findIndex(t=>t[u]==a);b(e)}function W(){var e,t;T(),(e=f.current)!=null&&e.parentElement?(G(!0),(t=d.current)==null||t.openPopup(f.current.parentElement)):console.warn("Select open field: element not found")}function C(){var e;T(),G(!1),(e=d.current)==null||e.closePopup()}function se(e){R(!0),h==null||h(e),setTimeout(()=>{var t,r;w&&!x&&!((r=(t=d.current)==null?void 0:t.popupPortal)!=null&&r.isEnter)&&W()},120)}function ae(e){R(!1),k==null||k(e),B&&C()}function ue(e){switch(E==null||E(e),e.key){case"Escape":C();break;case"Enter":x?V(m):W();break;case"ArrowDown":if(x){e.preventDefault();const t=m===void 0?0:(m+1)%i.length;b(t)}break;case"ArrowUp":if(x){e.preventDefault();const t=m===void 0?i.length-1:(m-1+i.length)%i.length;b(t)}break}}function fe(e){var t,r,l;s&&(j(e.target.value),!((r=(t=d.current)==null?void 0:t.popupPortal)!=null&&r.isEnter)&&f.current&&((l=d.current)==null||l.openPopup(f.current.parentElement)))}function ie(){return z||(F?o(he,{size:16,weight:2}):s&&S?o(ke,{size:16,color:N("colorTextGray")}):x?o(Ee,{size:16,color:N("colorTextGray")}):o(Re,{size:16,color:N("colorTextGray")}))}return o(Oe,{ref:d,trigger:"click",equalWidth:"equal",menus:i,onMenuItemClick:(e,t)=>{V(t)},...p,portalOptions:{escToClose:!0,...p==null?void 0:p.portalOptions},children:xe("div",{className:ne,style:re,css:[ye,Se,Te],onKeyDown:ue,...ee,children:[Z,o("input",{ref:f,css:be,readOnly:!s,placeholder:X,value:ce,className:pe({cud:!s}),onFocus:se,onBlur:ae,onChange:fe}),ie()]})})});try{A.displayName="Select",A.__docgenInfo={description:"",displayName:"Select",props:{}}}catch{}export{A as S};
