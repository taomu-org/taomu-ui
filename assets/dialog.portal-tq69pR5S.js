var D=Object.defineProperty;var k=n=>{throw TypeError(n)};var R=(n,o,t)=>o in n?D(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t;var c=(n,o,t)=>R(n,typeof o!="symbol"?o+"":o,t),S=(n,o,t)=>o.has(n)||k("Cannot "+t);var d=(n,o,t)=>(S(n,o,"read from private field"),t?t.call(n):o.get(n)),O=(n,o,t)=>o.has(n)?k("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(n):o.set(n,t);import{a as C}from"./mini-scrollbar-1dk_y2Qh.js";import{R as y}from"./index-D4lIrffr.js";import"./index-CfuAEkNK.js";import{p as m}from"./popup.store-CZruyQcO.js";import{D as P}from"./dialog-BMg1r54e.js";import{P as B}from"./popup-trigger-GAT61Aah.js";var u;class E extends B{constructor(t,e={},a={}){const{onBeforeLeave:s,...l}=a;a=Object.assign(b(),l,{onBeforeLeave:r=>{var i,p;(p=(i=this.dialogOptions)==null?void 0:i.onClose)==null||p.call(i),s==null||s(r)}});super(r=>{const i=d(this,u);return C(i,{...r})},a);c(this,"Content",()=>null);c(this,"asyncCallbackRef",y.createRef());O(this,u,t=>{const e=this.DialogContent;return C(P,{...this.dialogOptions,onClose:this.close,dialogPortalInstance:this,children:C(e,{...t,dialogPortalInstance:this,defineOnOk:this.defineOnOk,defineOnCancel:this.defineOnCancel})})});c(this,"defineOnOk",t=>{this.asyncCallbackRef.current||(this.asyncCallbackRef.current={}),this.asyncCallbackRef.current.onOk=t});c(this,"defineOnCancel",t=>{this.asyncCallbackRef.current||(this.asyncCallbackRef.current={}),this.asyncCallbackRef.current.onCancel=t});c(this,"open",(t,e={},a={})=>new Promise((s,l)=>{const r={...e},i=e.asyncCallback;r.asyncCallback=(g,f)=>{i==null||i(g,f),g==="ok"?s(f):l(f)};const p=a.onBackgroundClickClose,h=a.onEscClose;a.onBackgroundClickClose=()=>{p==null||p(),l()},a.onEscClose=()=>{h==null||h(),l()},this.updateDialogOptionsStatic(r),a&&this.updateBaseOptionsStatic(a),this.baseOpen(t)}));c(this,"dispatchUpdate",(t,e={},a={})=>{const{popupsMap:s,updateCount:l}=m.getState();s.has(this.popupId)&&(e&&this.updateDialogOptionsStatic(e),a&&this.updateBaseOptionsStatic(a),s.set(this.popupId,[this,t]),m.setState({popupsMap:s,updateCount:l+1}))});c(this,"updateDialogOptionsStatic",t=>{Object.assign(this.dialogOptions,t)});c(this,"updateBaseOptionsStatic",t=>{Object.assign(this.baseOptions,t)});this.DialogContent=t,this.dialogOptions=e,this.baseOptions=a,this.Content=d(this,u)}}u=new WeakMap;function b(){return{positionType:"dialog-center",contentAnimationConfig:"dialogZoomOut",overlay:!0,clickToClose:!1,lockScroll:!0,createContainerId:"taomu-dialog-container"}}export{E as D};
